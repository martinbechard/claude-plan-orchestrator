meta:
  name: Pipeline Startup Sweep for Uncommitted Archival Artifacts
  description: 'Add a startup sweep function that detects and commits orphaned archival
    artifacts left by interrupted pipeline sessions, and enhance the signal handler
    to attempt committing in-flight archive changes before exiting.

    '
  plan_doc: docs/plans/2026-02-24-1-pipeline-lacks-startup-sweep-for-uncommitted-archival-artifacts-design.md
  created: '2026-02-24'
  max_attempts_default: 3
  source_item: docs/defect-backlog/1-pipeline-lacks-startup-sweep-for-uncommitted-archival-artifacts.md
  validation:
    enabled: true
    run_after:
    - coder
    validators:
    - validator
    max_validation_attempts: 2
sections:
- id: phase-1
  name: Phase 1 - Startup Sweep and Signal Handler Enhancement
  status: completed
  tasks:
  - id: '1.1'
    name: Add startup sweep function and integrate into pipeline startup
    agent: coder
    status: completed
    description: 'Implement the startup sweep and signal handler enhancement described
      in docs/defect-backlog/1-pipeline-lacks-startup-sweep-for-uncommitted-archival-artifacts.md

      Design reference: docs/plans/2026-02-24-1-pipeline-lacks-startup-sweep-for-uncommitted-archival-artifacts-design.md

      Key files: scripts/auto-pipeline.py

      '
    attempts: 3
    last_attempt: '2026-02-24T19:05:12.953316'
    model_used: sonnet
    validation_findings: 'Validator ''validator'' failed to execute: No status file
      written by Claude'
    validation_attempts: 2
    completed_at: '2026-02-24T19:06:08.443111'
    result_message: Startup sweep function (sweep_uncommitted_archival_artifacts)
      and signal handler enhancement already implemented and committed in fbf2225.
      Constants ARCHIVAL_SWEEP_DIRS and SWEEP_COMMIT_MESSAGE defined, function called
      in main() after write_pid_file(). Syntax verified clean.
- id: phase-2
  name: Phase 2 - Unit Tests
  status: completed
  tasks:
  - id: '2.1'
    name: Add unit tests for startup sweep and signal handler commit
    agent: coder
    depends_on:
    - '1.1'
    status: completed
    description: 'Add unit tests for the startup sweep and signal handler changes
      described in docs/defect-backlog/1-pipeline-lacks-startup-sweep-for-uncommitted-archival-artifacts.md

      Design reference: docs/plans/2026-02-24-1-pipeline-lacks-startup-sweep-for-uncommitted-archival-artifacts-design.md

      Key files: tests/test_auto_pipeline.py

      '
    attempts: 3
    last_attempt: '2026-02-24T19:15:31.019390'
    model_used: sonnet
    validation_findings: 'Validator ''validator'' failed to execute: No status file
      written by Claude'
    validation_attempts: 2
    completed_at: '2026-02-24T19:16:18.544714'
    result_message: 'Unit tests for startup sweep and signal handler already implemented
      from prior attempts. All 7 tests pass: test_sweep_commits_orphaned_archival_files,
      test_sweep_is_noop_when_clean, test_sweep_logs_artifact_count, test_sweep_handles_git_status_failure,
      test_handle_signal_commits_inflight_artifacts, test_handle_signal_skips_commit_when_no_archival_paths,
      test_handle_signal_continues_shutdown_if_commit_fails.'
