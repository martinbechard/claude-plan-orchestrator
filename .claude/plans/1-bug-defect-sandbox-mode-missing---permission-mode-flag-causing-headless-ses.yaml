meta:
  name: 'Fix: Sandbox mode missing --permission-mode flag causing headless session
    deadlock'
  description: Add --permission-mode acceptEdits to build_permission_flags() in both
    plan-orchestrator.py and auto-pipeline.py when sandbox is enabled. Without this
    flag, the Claude CLI defaults to interactive approval prompts for Write/Edit,
    which deadlocks when running with stdin=subprocess.DEVNULL.
  source_item: docs/defect-backlog/1-bug-defect-sandbox-mode-missing---permission-mode-flag-causing-headless-ses.md
  plan_doc: docs/plans/2026-02-24-1-bug-defect-sandbox-mode-missing---permission-mode-flag-causing-headless-ses-design.md
  created: '2026-02-24'
  max_attempts_default: 3
  validation:
    enabled: true
    run_after:
    - coder
    validators:
    - validator
    max_validation_attempts: 2
sections:
- id: phase-1
  name: Phase 1 - Add --permission-mode acceptEdits to sandbox permission flags
  status: pending
  tasks:
  - id: '1.1'
    name: Add --permission-mode acceptEdits to build_permission_flags() in both scripts
    agent: coder
    status: in_progress
    description: 'Implement the work item: docs/defect-backlog/1-bug-defect-sandbox-mode-missing---permission-mode-flag-causing-headless-ses.md


      Design doc: docs/plans/2026-02-24-1-bug-defect-sandbox-mode-missing---permission-mode-flag-causing-headless-ses-design.md


      Files: scripts/plan-orchestrator.py, scripts/auto-pipeline.py,

      tests/test_plan_orchestrator.py, tests/test_auto_pipeline.py

      '
    attempts: 2
    last_attempt: '2026-02-24T18:22:31.629015'
    model_used: sonnet
    validation_findings: 'Validator ''validator'' failed to execute: No status file
      written by Claude'
    validation_attempts: 1
