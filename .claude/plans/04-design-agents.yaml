meta:
  name: Design Agents for Phase 0 Competitions
  description: 'Create specialized design agents (systems-designer, ux-designer, planner)
    for Phase 0 design competitions. Extends the agent framework from feature 02 with
    design-specific agents, inference keyword expansion, and template updates.

    '
  plan_doc: docs/plans/2026-02-14-04-design-agents-design.md
  created: '2026-02-14'
  max_attempts_default: 3
  validation:
    enabled: true
    run_after:
    - coder
    validators:
    - validator
    max_validation_attempts: 1
sections:
- id: phase-1
  name: Phase 1 - Agent Definition Files
  status: completed
  tasks:
  - id: '1.1'
    name: Create systems-designer agent definition
    agent: coder
    status: completed
    description: "Create the systems-designer agent definition file at .claude/agents/systems-designer.md\n\
      \nUse the same markdown-with-YAML-frontmatter format as the existing agents.\n\
      Reference .claude/agents/coder.md and .claude/agents/code-reviewer.md for format\
      \ examples.\n\nFrontmatter fields:\n  name: systems-designer\n  description:\
      \ \"Architecture and data model design agent. Produces design documents\n  \
      \  with TypeScript interfaces, component hierarchy, data flow, and API boundaries.\n\
      \    Read-only: does not write code.\"\n  tools: [Read, Grep, Glob]\n  model:\
      \ opus\n\nBody sections:\n\n1. Role: You are a systems design specialist. Your\
      \ job is to create detailed\n   architecture designs for Phase 0 design competitions.\
      \ You produce design documents,\n   NOT code. You analyze existing code to inform\
      \ your designs but never modify files.\n\n2. Before Designing checklist:\n \
      \  - Read the competition brief / task description thoroughly\n   - Read existing\
      \ source code in the areas the feature will touch\n   - Identify existing patterns,\
      \ data models, and API boundaries\n   - Read the design document referenced\
      \ in the task (if any)\n\n3. Design Output Structure:\n   Your design document\
      \ must include these sections:\n   - Architecture Overview: high-level component\
      \ diagram (ASCII)\n   - Data Models: TypeScript interfaces for all new data\
      \ shapes\n   - Component Hierarchy: parent-child relationships, props flow\n\
      \   - API Boundaries: endpoints, request/response shapes, error cases\n   -\
      \ Integration Points: how new code connects to existing modules\n   - Trade-off\
      \ Analysis: alternatives considered, pros/cons of chosen approach\n   - Scalability\
      \ Considerations: how the design handles growth\n\n4. Evaluation Criteria (what\
      \ the judge scores):\n   - Scalability (0-10): handles growth without redesign\n\
      \   - Maintainability (0-10): clear separation, testable units\n   - Integration\
      \ (0-10): fits existing codebase patterns\n   - Completeness (0-10): all requirements\
      \ addressed\n   - Feasibility (0-10): implementable within project constraints\n\
      \n5. Constraints:\n   - Read-only: do NOT use Write, Edit, or Bash to modify\
      \ files\n   - Write your design document to the OUTPUT path specified in the\
      \ task\n   - Use ASCII diagrams, not images\n\n6. Output Protocol:\n   Write\
      \ task-status.json when done with task_id, status, message, timestamp,\n   plan_modified\
      \ fields.\n\nReference: docs/plans/2026-02-14-04-design-agents-design.md\n"
    attempts: 1
    last_attempt: '2026-02-14T08:47:07.644587'
    completed_at: '2026-02-14T08:49:38.561803'
    result_message: 'Created systems-designer agent definition at .claude/agents/systems-designer.md
      with YAML frontmatter (name, description, tools: [Read, Grep, Glob], model:
      opus) and body sections for Role, Before Designing checklist, Design Output
      Structure, Evaluation Criteria, Constraints, and Output Protocol. Validated
      frontmatter parsing and committed.'
  - id: '1.2'
    name: Create ux-designer agent definition
    agent: coder
    status: completed
    description: "Create the ux-designer agent definition file at .claude/agents/ux-designer.md\n\
      \nUse the same markdown-with-YAML-frontmatter format as existing agents.\nReference\
      \ .claude/agents/coder.md for format examples.\n\nFrontmatter fields:\n  name:\
      \ ux-designer\n  description: \"Visual and interaction design agent. Produces\
      \ UX design documents\n    with ASCII wireframes, component specs, state diagrams,\
      \ and user workflows.\n    Read-only: does not write code.\"\n  tools: [Read,\
      \ Grep, Glob]\n  model: opus\n\nBody sections:\n\n1. Role: You are a UX design\
      \ specialist. Your job is to create detailed visual\n   and interaction designs\
      \ for Phase 0 design competitions. You produce design\n   specs, NOT code. You\
      \ analyze existing UI code to maintain consistency.\n\n2. Before Designing checklist:\n\
      \   - Read the competition brief / task description thoroughly\n   - Read existing\
      \ UI components to understand the design system\n   - Identify layout patterns,\
      \ color schemes, typography in use\n   - Read the design document referenced\
      \ in the task (if any)\n\n3. Design Output Structure:\n   Your design document\
      \ must include these sections:\n   - User Flow: step-by-step interaction sequence\n\
      \   - Wireframes: ASCII wireframes for all states (normal, loading, error, empty)\n\
      \   - Component Specs: dimensions, spacing, interactive behaviors\n   - State\
      \ Diagrams: component state transitions\n   - Responsive Design: mobile, tablet,\
      \ desktop breakpoints\n   - Accessibility: ARIA roles, keyboard navigation,\
      \ screen reader support\n   - Design System Integration: which existing components\
      \ to reuse vs. create\n\n4. Evaluation Criteria (what the judge scores):\n \
      \  - Clarity (0-10): is the design easy to understand and implement?\n   - Mobile\
      \ UX (0-10): works well on small screens\n   - Accessibility (0-10): inclusive\
      \ design practices\n   - Consistency (0-10): matches existing design patterns\n\
      \   - Completeness (0-10): all states and edge cases covered\n\n5. Constraints:\n\
      \   - Read-only: do NOT use Write, Edit, or Bash to modify files\n   - Write\
      \ your design document to the OUTPUT path specified in the task\n   - Use ASCII\
      \ wireframes for visual layouts\n\n6. Output Protocol:\n   Write task-status.json\
      \ when done with task_id, status, message, timestamp,\n   plan_modified fields.\n\
      \nReference: docs/plans/2026-02-14-04-design-agents-design.md\n"
    attempts: 1
    last_attempt: '2026-02-14T08:49:40.610511'
    completed_at: '2026-02-14T08:51:45.549938'
    result_message: 'Created ux-designer agent definition at .claude/agents/ux-designer.md
      with YAML frontmatter (name, description, tools: [Read, Grep, Glob], model:
      opus) and body sections for Role, Before Designing checklist, Design Output
      Structure, Evaluation Criteria, Constraints, and Output Protocol. Validated
      frontmatter parsing and committed.'
  - id: '1.3'
    name: Create planner agent definition
    agent: coder
    status: completed
    description: "Create the planner agent definition file at .claude/agents/planner.md\n\
      \nUse the same markdown-with-YAML-frontmatter format as existing agents.\nReference\
      \ .claude/agents/coder.md for format examples.\n\nFrontmatter fields:\n  name:\
      \ planner\n  description: \"Design-to-implementation bridge agent. Reads winning\
      \ designs and\n    creates YAML implementation phases with proper dependencies\
      \ and agent assignments.\n    Sets plan_modified: true for orchestrator reload.\"\
      \n  tools: [Read, Write, Bash, Grep, Glob]\n  model: sonnet\n\nBody sections:\n\
      \n1. Role: You are an implementation planner. Your job is to read a winning\
      \ design\n   from a Phase 0 competition and translate it into concrete YAML\
      \ implementation\n   phases that the orchestrator can execute. You bridge the\
      \ gap between design\n   and implementation.\n\n2. Before Planning checklist:\n\
      \   - Read the winning design document thoroughly\n   - Read the judge's feedback\
      \ and scoring (if available)\n   - Read the existing YAML plan to understand\
      \ current structure\n   - Read the project's coding rules (CODING-RULES.md or\
      \ equivalent)\n   - Identify which files need to be created vs. modified\n\n\
      3. Plan Output Structure:\n   Append new sections to the YAML plan with:\n \
      \  - Proper section IDs continuing from the last section\n   - Task IDs continuing\
      \ from the last task\n   - Task descriptions detailed enough for a fresh Claude\
      \ session\n   - Agent assignments (coder for implementation, code-reviewer for\
      \ verification)\n   - Dependencies between tasks reflecting build order\n  \
      \ - parallel_group assignments for independent tasks\n   - A final verification\
      \ task\n\n4. Plan Quality Criteria:\n   - Each task completable in one Claude\
      \ session (under 10 minutes)\n   - Task descriptions include specific file paths\
      \ and what to change\n   - Dependencies form a valid DAG (no cycles)\n   - Verification\
      \ tasks check both build and tests\n   - Follow docs -> code -> tests -> verification\
      \ order\n\n5. Constraints:\n   - Use Write tool to modify the YAML plan file\n\
      \   - Set plan_modified: true in the status file so orchestrator reloads\n \
      \  - Do NOT implement any code; only create the plan\n   - Follow the exact\
      \ YAML schema used by plan-orchestrator.py\n\n6. Output Protocol:\n   Write\
      \ task-status.json with plan_modified: true (critical for reload).\n\nReference:\
      \ docs/plans/2026-02-14-04-design-agents-design.md\n"
    attempts: 1
    last_attempt: '2026-02-14T08:51:47.597280'
    completed_at: '2026-02-14T08:54:12.887606'
    result_message: 'Created planner agent definition at .claude/agents/planner.md
      with YAML frontmatter (name, description, tools: [Read, Write, Bash, Grep, Glob],
      model: sonnet) and body sections for Role, Before Planning checklist, Plan Output
      Structure, Plan Quality Criteria, Constraints, and Output Protocol. Validated
      frontmatter parsing and committed.'
- id: phase-2
  name: Phase 2 - Orchestrator Inference Changes
  status: completed
  tasks:
  - id: '2.1'
    name: Add DESIGNER_KEYWORDS and PLANNER_KEYWORDS constants
    agent: coder
    status: completed
    depends_on:
    - '1.3'
    description: "In scripts/plan-orchestrator.py, add two new keyword constant lists\
      \ alongside\nthe existing REVIEWER_KEYWORDS (currently at line ~134).\n\nAfter\
      \ REVIEWER_KEYWORDS, add:\n\n# Keywords indicating a design/architecture task.\n\
      # When infer_agent_for_task() matches any of these, it selects \"systems-designer\"\
      .\nDESIGNER_KEYWORDS = [\n    \"design\", \"wireframe\", \"layout\", \"architecture\"\
      , \"mockup\"\n]\n\n# Keywords indicating a plan-generation task.\n# When infer_agent_for_task()\
      \ matches any of these, it selects \"planner\".\nPLANNER_KEYWORDS = [\n    \"\
      extend plan\", \"create tasks\", \"create phases\", \"plan sections\",\n   \
      \ \"append implementation\"\n]\n\nThese follow the exact same pattern as REVIEWER_KEYWORDS:\
      \ module-level constants\nwith a comment explaining their purpose.\n\nReference:\
      \ scripts/plan-orchestrator.py lines 131-136 for existing pattern.\nReference:\
      \ docs/plans/2026-02-14-04-design-agents-design.md\n"
    attempts: 1
    last_attempt: '2026-02-14T08:54:14.937395'
    completed_at: '2026-02-14T08:55:47.282318'
    result_message: Added DESIGNER_KEYWORDS and PLANNER_KEYWORDS constants in scripts/plan-orchestrator.py
      after REVIEWER_KEYWORDS (lines 138-149). DESIGNER_KEYWORDS contains 5 single-word
      design terms mapping to systems-designer. PLANNER_KEYWORDS contains 5 multi-word
      phrases mapping to planner. Both follow the existing REVIEWER_KEYWORDS pattern
      with explanatory comments. Python syntax verified.
  - id: '2.2'
    name: Expand infer_agent_for_task to support design and planner agents
    agent: coder
    status: completed
    depends_on:
    - '2.1'
    description: "In scripts/plan-orchestrator.py, modify the infer_agent_for_task()\
      \ function\n(currently at line ~150) to support the new agent types.\n\nCurrent\
      \ logic:\n1. Check AGENTS_DIR exists, return None if not\n2. Scan description\
      \ for REVIEWER_KEYWORDS -> return \"code-reviewer\"\n3. Default -> return \"\
      coder\"\n\nNew logic:\n1. Check AGENTS_DIR exists, return None if not\n2. Combine\
      \ task name and description for scanning:\n   text = (task.get(\"name\", \"\"\
      ) + \" \" + task.get(\"description\", \"\")).lower()\n3. Check REVIEWER_KEYWORDS\
      \ first (preserve existing behavior) -> return \"code-reviewer\"\n4. Check PLANNER_KEYWORDS\
      \ (multi-word phrases, checked before single-word DESIGNER_KEYWORDS)\n   ->\
      \ return \"planner\"\n5. Check DESIGNER_KEYWORDS -> return \"systems-designer\"\
      \n6. Default -> return \"coder\"\n\nIMPORTANT: PLANNER_KEYWORDS must be checked\
      \ BEFORE DESIGNER_KEYWORDS because planner\nkeywords are multi-word phrases\
      \ that are more specific. DESIGNER_KEYWORDS contains\nsingle words like \"design\"\
      \ that would match too broadly if checked first.\n\nUpdate the docstring to\
      \ reflect the new 4-outcome inference logic and the\nname+description scanning.\n\
      \nReference: scripts/plan-orchestrator.py lines 150-169 for current function.\n\
      Reference: docs/plans/2026-02-14-04-design-agents-design.md\n"
    attempts: 1
    last_attempt: '2026-02-14T08:55:49.332567'
    completed_at: '2026-02-14T08:57:37.162316'
    result_message: 'Expanded infer_agent_for_task() to scan both task name and description,
      supporting 4 outcomes: code-reviewer (REVIEWER_KEYWORDS), planner (PLANNER_KEYWORDS,
      checked before designer for specificity), systems-designer (DESIGNER_KEYWORDS),
      and coder (default). Updated docstring to reflect new logic.'
- id: phase-3
  name: Phase 3 - Template Updates
  status: completed
  tasks:
  - id: '3.1'
    name: Update PLAN_CREATION_PROMPT_TEMPLATE agent list
    agent: coder
    status: completed
    depends_on:
    - '2.2'
    description: "In scripts/auto-pipeline.py, update the Agent Selection section\
      \ within\nPLAN_CREATION_PROMPT_TEMPLATE (currently at line ~677) to list all\
      \ agents\nincluding the three new design agents.\n\nCurrent agent list (2 agents):\n\
      - **coder**: Implementation specialist...\n- **code-reviewer**: Read-only reviewer...\n\
      \nReplace with expanded list (5 agents shown in template, plus mention of\n\
      validator and issue-verifier which are used in the validation pipeline):\n\n\
      - **coder**: Implementation specialist. Use for coding, implementation, and\n\
      \  modification tasks. This is the default if no agent is specified.\n- **code-reviewer**:\
      \ Read-only reviewer. Use for verification, review, and\n  compliance-checking\
      \ tasks.\n- **systems-designer**: Architecture and data model designer. Use\
      \ for Phase 0\n  design competition tasks that focus on system architecture,\
      \ data models,\n  and API boundaries. Read-only.\n- **ux-designer**: Visual\
      \ and interaction designer. Use for Phase 0\n  design competition tasks that\
      \ focus on wireframes, user workflows,\n  and UI component specs. Read-only.\n\
      - **planner**: Design-to-implementation bridge. Use for tasks that read a\n\
      \  winning design and create YAML implementation phases. Sets plan_modified:\
      \ true.\n\nAlso add an example showing Phase 0 agent assignments after the existing\
      \ examples:\n\nPhase 0 Competition Example:\n  - id: '0.1'\n    name: Generate\
      \ Design 1\n    agent: systems-designer\n    parallel_group: phase-0-designs\n\
      \    status: pending\n    description: ...\n\n  - id: '0.7'\n    name: Extend\
      \ plan with implementation tasks\n    agent: planner\n    status: pending\n\
      \    description: ...\n\nUpdate the inference description to mention the new\
      \ keywords:\n\"If you do not set the agent field, the orchestrator will infer\
      \ it from the\ntask name and description (review/verification -> code-reviewer,\
      \ design/architecture\n-> systems-designer, plan extension -> planner, everything\
      \ else -> coder).\"\n\nReference: scripts/auto-pipeline.py lines 677-701 for\
      \ current template section.\nReference: docs/plans/2026-02-14-04-design-agents-design.md\n"
    attempts: 1
    last_attempt: '2026-02-14T10:16:30.596306'
    completed_at: '2026-02-14T10:18:38.731073'
    result_message: 'Updated PLAN_CREATION_PROMPT_TEMPLATE Agent Selection section:
      expanded agent list from 2 to 5 agents (added systems-designer, ux-designer,
      planner), added Phase 0 Competition Example with agent assignments and parallel_group,
      updated inference description to cover all 4 keyword-to-agent mappings.'
  - id: '3.2'
    name: Update implement skill Phase 0 template with agent assignments
    agent: coder
    status: completed
    depends_on:
    - '3.1'
    description: "In .claude/skills/implement/SKILL.md, update the Phase 0 Design\
      \ Competition\nsection (starts at line ~178) to show agent assignments for design\
      \ tasks.\n\nChanges to make:\n\n1. In the Phase 0 example YAML (lines ~184-213),\
      \ add agent fields to the\n   design generation tasks:\n\n   - id: '0.1'\n \
      \    name: Generate Design 1 - Approach A\n     agent: systems-designer    \
      \      # ADD THIS LINE\n     parallel_group: phase-0-designs\n     ...\n\n2.\
      \ Add agent field to the plan extension task:\n\n   - id: '0.7'\n     name:\
      \ Extend plan with implementation tasks\n     agent: planner               \
      \    # ADD THIS LINE\n     depends_on: ['0.6']\n     ...\n\n3. After the existing\
      \ Phase 0 example, add a new subsection:\n\n   ### Agent Team Dispatch (Design\
      \ Pairs)\n\n   For features requiring both architecture and UX design, assign\
      \ complementary\n   agent pairs in the same parallel group:\n\n   ```yaml\n\
      \   - id: '0.1'\n     name: Systems Design - Approach A\n     agent: systems-designer\n\
      \     parallel_group: phase-0-designs\n     description: |\n       Create architecture\
      \ design for approach A.\n       OUTPUT: Write to docs/plans/feature-design-1-systems.md\n\
      \   - id: '0.2'\n     name: UX Design - Approach A\n     agent: ux-designer\n\
      \     parallel_group: phase-0-designs\n     description: |\n       Create UX\
      \ design complementing approach A.\n       OUTPUT: Write to docs/plans/feature-design-1-ux.md\n\
      \   ```\n\n   The judge task evaluates both designs as a pair, scoring holistically.\n\
      \nDo NOT change anything else in the SKILL.md file. Keep all existing content\
      \ intact.\n\nReference: .claude/skills/implement/SKILL.md lines 178-216 for\
      \ current section.\nReference: docs/plans/2026-02-14-04-design-agents-design.md\n"
    attempts: 1
    last_attempt: '2026-02-14T10:18:40.781259'
    completed_at: '2026-02-14T10:20:30.103668'
    result_message: 'Updated implement skill Phase 0 template: added agent: systems-designer
      to task 0.1, agent: planner to task 0.7, and new Agent Team Dispatch (Design
      Pairs) subsection showing complementary agent pairs in parallel groups.'
- id: phase-4
  name: Phase 4 - Verification
  status: pending
  tasks:
  - id: '4.1'
    name: Verify agent files and inference logic
    agent: code-reviewer
    status: pending
    depends_on:
    - '3.2'
    description: "Run verification checks to confirm the design agents feature works\
      \ correctly.\n\n1. Verify all three new agent files exist and have valid frontmatter:\n\
      \n   python3 -c \"\n   import yaml, os\n   for agent in ['systems-designer',\
      \ 'ux-designer', 'planner']:\n       path = f'.claude/agents/{agent}.md'\n \
      \      assert os.path.exists(path), f'Missing: {path}'\n       content = open(path).read()\n\
      \       parts = content.split('---', 2)\n       assert len(parts) >= 3, f'Invalid\
      \ frontmatter in {path}'\n       meta = yaml.safe_load(parts[1])\n       assert\
      \ 'name' in meta, f'Missing name in {path}'\n       assert 'description' in\
      \ meta, f'Missing description in {path}'\n       assert 'tools' in meta, f'Missing\
      \ tools in {path}'\n       assert 'model' in meta, f'Missing model in {path}'\n\
      \       print(f'OK: {path} - name={meta[\\\"name\\\"]}, model={meta[\\\"model\\\
      \"]}')\n   print('All new agent files valid')\n   \"\n\n2. Verify inference\
      \ logic handles all four outcomes:\n\n   python3 -c \"\n   import sys, os\n\
      \   sys.path.insert(0, 'scripts')\n   os.environ['_TESTING'] = '1'\n\n   REVIEWER_KEYWORDS\
      \ = ['verify', 'review', 'check', 'validate', 'regression', 'compliance']\n\
      \   DESIGNER_KEYWORDS = ['design', 'wireframe', 'layout', 'architecture', 'mockup']\n\
      \   PLANNER_KEYWORDS = ['extend plan', 'create tasks', 'create phases', 'plan\
      \ sections', 'append implementation']\n\n   def infer(name, desc):\n       text\
      \ = (name + ' ' + desc).lower()\n       for kw in REVIEWER_KEYWORDS:\n     \
      \      if kw in text:\n               return 'code-reviewer'\n       for kw\
      \ in PLANNER_KEYWORDS:\n           if kw in text:\n               return 'planner'\n\
      \       for kw in DESIGNER_KEYWORDS:\n           if kw in text:\n          \
      \     return 'systems-designer'\n       return 'coder'\n\n   assert infer('',\
      \ 'Verify build passes') == 'code-reviewer', 'reviewer failed'\n   assert infer('',\
      \ 'Implement the feature') == 'coder', 'coder failed'\n   assert infer('Generate\
      \ Design 1', '') == 'systems-designer', 'designer from name failed'\n   assert\
      \ infer('', 'Create architecture design') == 'systems-designer', 'designer from\
      \ desc failed'\n   assert infer('', 'Extend plan with implementation') == 'planner',\
      \ 'planner failed'\n   assert infer('', 'Create phases for implementation')\
      \ == 'planner', 'planner phrase failed'\n   assert infer('', 'Review the design')\
      \ == 'code-reviewer', 'reviewer priority failed'\n   print('All inference tests\
      \ passed')\n   \"\n\n3. Verify no Python syntax errors in both scripts:\n\n\
      \   python3 -c \"import py_compile; py_compile.compile('scripts/auto-pipeline.py',\
      \ doraise=True); py_compile.compile('scripts/plan-orchestrator.py', doraise=True)\"\
      \n\n4. Verify orchestrator dry-run still works:\n\n   python3 -m pytest tests/\
      \ 2>/dev/null || echo 'No test suite configured'\n\nIf any check fails, report\
      \ the failure with specific details.\n\nReference: docs/plans/2026-02-14-04-design-agents-design.md\n"
