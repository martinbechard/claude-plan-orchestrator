meta:
  name: Design Agents for Phase 0 Competitions
  description: 'Create specialized design agents (systems-designer, ux-designer, planner)
    that replace generic Claude sessions in Phase 0 design competitions. Includes
    agent definition files, orchestrator inference expansion, template updates, and
    documentation updates. Builds on the agent definition framework (feature 02).

    '
  plan_doc: docs/plans/2026-02-13-04-design-agents-design.md
  created: '2026-02-13'
  max_attempts_default: 3
sections:
- id: phase-1
  name: Phase 1 - Agent Definition Files
  status: pending
  tasks:
  - id: '1.1'
    name: Create systems-designer agent definition
    status: pending
    description: "Create .claude/agents/systems-designer.md with YAML frontmatter\
      \ and markdown body.\nReference the existing coder.md and code-reviewer.md in\
      \ .claude/agents/ for format. Reference the design doc: docs/plans/2026-02-13-04-design-agents-design.md\n\
      \nFrontmatter fields:\n  name: systems-designer\n  description: \"Architecture\
      \ and data model design specialist for Phase 0 competitions.\n    Produces TypeScript\
      \ interfaces, component hierarchies, data flow diagrams, and\n    integration\
      \ analysis. Read-only - produces design documents, not code.\"\n  tools: [Read,\
      \ Grep, Glob]\n  model: opus\n\n\nBody sections to include:\n\n1. Role: You\
      \ are a systems architect specializing in software design. Your job is to\n\
      \   create detailed architectural designs for features during Phase 0 design\
      \ competitions.\n   You are READ-ONLY and produce design documents, not code.\n\
      \n\n2. Before Designing checklist:\n   - Read the design competition brief/task\
      \ description carefully\n   - Read existing codebase architecture (component\
      \ hierarchy, data models, API patterns)\n   - Read CODING-RULES.md to understand\
      \ project conventions\n   - Identify existing patterns that the design should\
      \ follow or extend\n\n\n3. Design Output Structure:\n   - Architecture Overview\
      \ (system diagram, component relationships)\n   - Data Models (TypeScript interfaces\
      \ for all entities and DTOs)\n   - Component Hierarchy (tree structure with\
      \ responsibilities)\n   - API Boundaries (endpoints, request/response shapes,\
      \ error handling)\n   - Data Flow (how data moves through the system)\n   -\
      \ Integration Points (how this design connects to existing code)\n   - Trade-off\
      \ Analysis (alternatives considered, pros/cons)\n   - Edge Cases and Error Scenarios\n\
      \n\n4. Evaluation Criteria (what the judge scores):\n   - Scalability (can the\
      \ design handle growth?)\n   - Maintainability (is the code easy to understand\
      \ and modify?)\n   - Integration (does it work with existing codebase patterns?)\n\
      \   - Completeness (are edge cases and errors addressed?)\n   - Simplicity (is\
      \ it the minimum viable design, not over-engineered?)\n\n\n5. Anti-Patterns\
      \ to Avoid:\n   - No over-engineering beyond what the feature requires\n   -\
      \ No reinventing patterns that already exist in the codebase\n   - No designs\
      \ that require massive refactoring of existing code\n   - No abstract frameworks\
      \ when concrete implementations suffice\n\n\n6. Output Protocol:\n   Write the\
      \ design to the output file specified in the task description.\n   Write task-status.json\
      \ when done with task_id, status, message, timestamp,\n   plan_modified fields.\n"
    attempts: 3
    last_attempt: '2026-02-13T23:00:01.820616'
    last_error: "Claude exited with code 1: error: unknown option '---\nname: code-reviewer\n\
      description: \"Read-only coding standards compliance reviewer. Checks naming,\
      \ types,\n  file size, coupling, error handling. Produces findings list with\
      \ severity ratings.\n  Does not modify code.\"\ntools:\n  - Read\n  - Grep\n\
      \  - Glob\nmodel: sonnet\n---\n\n# Code Reviewer Agent\n\n## Role\n\nYou are\
      \ a code quality reviewer. Your job is to independently review code changes\n\
      for compliance with CODING-RULES.md. You are READ-ONLY and must NOT modify any\
      \ code\nfiles. Y"
  - id: '1.2'
    name: Create ux-designer agent definition
    status: pending
    description: "Create .claude/agents/ux-designer.md with YAML frontmatter and markdown\
      \ body.\nReference the existing coder.md and code-reviewer.md in .claude/agents/\
      \ for format. Reference the design doc: docs/plans/2026-02-13-04-design-agents-design.md\n\
      \nFrontmatter fields:\n  name: ux-designer\n  description: \"Visual and interaction\
      \ design specialist for Phase 0 competitions.\n    Produces ASCII wireframes,\
      \ component specs, state diagrams, and user workflow\n    documentation. Read-only\
      \ - produces design documents, not code.\"\n  tools: [Read, Grep, Glob]\n  model:\
      \ opus\n\n\nBody sections to include:\n\n1. Role: You are a UX designer specializing\
      \ in developer tool and web application\n   interfaces. Your job is to create\
      \ detailed visual and interaction designs for\n   features during Phase 0 design\
      \ competitions. You are READ-ONLY and produce\n   design documents, not code.\n\
      \n\n2. Before Designing checklist:\n   - Read the design competition brief/task\
      \ description carefully\n   - Read existing UI components and pages to understand\
      \ the design system\n   - Identify the existing visual patterns (layout, spacing,\
      \ color usage)\n   - Understand the target user workflow and pain points\n\n\
      \n3. Design Output Structure:\n   - User Workflow (step-by-step interaction\
      \ flow)\n   - ASCII Wireframes (for each state: normal, loading, error, empty)\n\
      \   - Component Specifications (props, states, behaviors)\n   - State Diagrams\
      \ (component state transitions)\n   - Responsive Layout (mobile and desktop\
      \ breakpoints)\n   - Accessibility Considerations (ARIA labels, keyboard nav,\
      \ color contrast)\n   - Interaction Specifications (hover, click, drag, keyboard\
      \ shortcuts)\n   - Visual Hierarchy (information density, scanning patterns)\n\
      \n\n4. Evaluation Criteria (what the judge scores):\n   - Clarity (is the UI\
      \ intuitive and self-explanatory?)\n   - Mobile UX (does it work well on small\
      \ screens?)\n   - Accessibility (WCAG compliance, keyboard navigation)\n   -\
      \ Consistency (matches existing design system patterns?)\n   - User Workflow\
      \ (efficient path to task completion?)\n\n\n5. Anti-Patterns to Avoid:\n   -\
      \ No designs that ignore the existing component library\n   - No desktop-only\
      \ layouts without mobile consideration\n   - No information overload on a single\
      \ screen\n   - No custom UI patterns when standard ones exist\n   - No designs\
      \ requiring JavaScript-heavy interactions when CSS suffices\n\n\n6. Output Protocol:\n\
      \   Write the design to the output file specified in the task description.\n\
      \   Write task-status.json when done with task_id, status, message, timestamp,\n\
      \   plan_modified fields.\n"
  - id: '1.3'
    name: Create planner agent definition
    status: pending
    description: "Create .claude/agents/planner.md with YAML frontmatter and markdown\
      \ body.\nReference the existing coder.md and code-reviewer.md in .claude/agents/\
      \ for format. Reference the design doc: docs/plans/2026-02-13-04-design-agents-design.md\n\
      \nFrontmatter fields:\n  name: planner\n  description: \"Design-to-implementation\
      \ bridge agent. Reads winning designs from\n    Phase 0 competitions and creates\
      \ valid YAML task sections with proper dependencies\n    and agent assignments.\
      \ Sets plan_modified: true for orchestrator reload.\"\n  tools: [Read, Write,\
      \ Bash, Grep, Glob]\n  model: sonnet\n\n\nBody sections to include:\n\n1. Role:\
      \ You are a project planner specializing in breaking designs into implementation\n\
      \   tasks. Your job is to read the winning design from a Phase 0 competition\
      \ and create\n   the implementation phases that follow. You produce valid YAML\
      \ plan sections that the\n   orchestrator can execute.\n\n\n2. Before Planning\
      \ checklist:\n   - Read the winning design document\n   - Read the judge's scoring\
      \ and improvement suggestions from runner-ups\n   - Read the current YAML plan\
      \ file to understand the existing structure\n   - Read .claude/plans/sample-plan.yaml\
      \ for the correct YAML format\n   - Understand the project's change workflow\
      \ order: docs -> code -> tests -> verification\n\n\n3. Planning Rules:\n   -\
      \ Follow the mandatory change workflow: documentation first, then code, then\
      \ tests,\n     then verification\n   - Each task should be completable in one\
      \ Claude session (under 10 minutes)\n   - Task descriptions must be detailed\
      \ enough for a fresh Claude session\n   - Include file paths in descriptions\
      \ for automatic conflict detection\n   - Set agent: coder for implementation\
      \ tasks\n   - Set agent: code-reviewer for review/verification tasks\n   - The\
      \ final section must include a verification task that runs the project build\n\
      \     and test commands\n   - Use depends_on to express task ordering within\
      \ and across sections\n   - Use parallel_group when tasks can safely run concurrently\n\
      \n\n4. YAML Format:\n   Sections follow this structure:\n     - id: phase-N\n\
      \       name: Phase N - Description\n       status: pending\n       tasks:\n\
      \       - id: 'N.1'\n         name: Task name\n         agent: coder\n     \
      \    status: pending\n         description: |\n           Detailed description...\n\
      \           Files: path/to/file.py\n         depends_on:\n         - 'previous.task.id'\n\
      \n\n5. Output Protocol:\n   Append the new sections to the YAML plan file specified\
      \ in the task description.\n   IMPORTANT: Set plan_modified: true in the task-status.json\
      \ so the orchestrator\n   reloads the plan with the new sections.\n"
- id: phase-2
  name: Phase 2 - Orchestrator Inference Updates
  status: pending
  tasks:
  - id: '2.1'
    name: Add design and planner keyword constants and expand inference
    status: pending
    description: "In scripts/plan-orchestrator.py, expand the agent inference system\
      \ to recognize design and planner tasks.\nReference: docs/plans/2026-02-13-04-design-agents-design.md\n\
      Reference: scripts/plan-orchestrator.py lines 130-157 for existing inference\
      \ code.\n\n1. Near line 133 (after REVIEWER_KEYWORDS), add two new module-level\
      \ constants:\n\n   DESIGNER_KEYWORDS = [\"design\", \"wireframe\", \"layout\"\
      , \"architecture\", \"mockup\"]\n\n   PLANNER_KEYWORDS = [\"extend plan\", \"\
      create tasks\", \"create phases\", \"plan sections\"]\n\n\n2. Modify infer_agent_for_task()\
      \ (line 138) to check keywords in priority order:\n   - First check REVIEWER_KEYWORDS\
      \ (existing, unchanged)\n   - Then check PLANNER_KEYWORDS -> return \"planner\"\
      \n   - Then check DESIGNER_KEYWORDS -> return \"systems-designer\"\n   - Default\
      \ -> return \"coder\"\n\n   The function should scan BOTH task.get(\"description\"\
      , \"\") AND task.get(\"name\", \"\")\n   converted to lowercase. This is because\
      \ Phase 0 tasks often have short names like\n   \"Generate Design 1\" where\
      \ the keyword appears in the name.\n\n   Updated function:\n\n   def infer_agent_for_task(task:\
      \ dict) -> Optional[str]:\n       if not os.path.isdir(AGENTS_DIR):\n      \
      \     return None\n       searchable = (task.get(\"description\", \"\") + \"\
      \ \" + task.get(\"name\", \"\")).lower()\n       for keyword in REVIEWER_KEYWORDS:\n\
      \           if keyword in searchable:\n               return \"code-reviewer\"\
      \n       for keyword in PLANNER_KEYWORDS:\n           if keyword in searchable:\n\
      \               return \"planner\"\n       for keyword in DESIGNER_KEYWORDS:\n\
      \           if keyword in searchable:\n               return \"systems-designer\"\
      \n       return \"coder\"\n\n\n3. Update the function docstring to document\
      \ all four agent outcomes and the\n   name+description scanning behavior.\n\n\
      \nIMPORTANT: Preserve the existing REVIEWER_KEYWORDS constant and its position.\
      \ Add the new constants immediately after it.\n"
  - id: '2.2'
    name: Update PLAN_CREATION_PROMPT_TEMPLATE with all agents
    status: pending
    description: "In scripts/auto-pipeline.py, update the PLAN_CREATION_PROMPT_TEMPLATE\
      \ (line 643) to list all five agents instead of just two.\nReference: docs/plans/2026-02-13-04-design-agents-design.md\n\
      Reference: scripts/auto-pipeline.py lines 677-701 for the existing Agent Selection\
      \ section.\n\nReplace the current agent list (lines 682-685) which only lists\
      \ coder and code-reviewer with the full list of five agents:\n- **coder**: Implementation\
      \ specialist. Use for coding, implementation, and\n  modification tasks. This\
      \ is the default if no agent is specified.\n- **code-reviewer**: Read-only reviewer.\
      \ Use for verification, review, and\n  compliance-checking tasks.\n- **systems-designer**:\
      \ Architecture and data model designer. Use for Phase 0\n  design competition\
      \ tasks focused on system architecture, data models, and APIs.\n- **ux-designer**:\
      \ Visual and interaction designer. Use for Phase 0 design\n  competition tasks\
      \ focused on UI layout, wireframes, and user workflows.\n- **planner**: Design-to-implementation\
      \ bridge. Use for tasks that read a winning\n  design and create YAML implementation\
      \ phases. Sets plan_modified: true.\n\n\nAlso add a Phase 0 agent assignment\
      \ example after the existing examples:\nFor Phase 0 design competitions, assign\
      \ agents to tasks:\n  - id: '0.1'\n    name: Systems Design - Approach A\n \
      \   agent: systems-designer\n    parallel_group: phase-0-designs\n    status:\
      \ pending\n    description: ...\n\n  - id: '0.6'\n    name: Judge and select\
      \ best design\n    status: pending\n    description: ...\n\n  - id: '0.7'\n\
      \    name: Extend plan with implementation tasks\n    agent: planner\n    status:\
      \ pending\n    description: ...\n\n\nIMPORTANT: Do NOT change the Python .format()\
      \ call - {agents_dir} is already a placeholder. Only modify the text content\
      \ within the template string.\n"
    depends_on:
    - '2.1'
- id: phase-3
  name: Phase 3 - Documentation Updates
  status: pending
  tasks:
  - id: '3.1'
    name: Update implement skill Phase 0 template with agent assignments
    status: pending
    description: "Update .claude/skills/implement/SKILL.md to show agent assignments\
      \ in the Phase 0 design competition template.\nReference: docs/plans/2026-02-13-04-design-agents-design.md\n\
      Reference: .claude/skills/implement/SKILL.md lines 178-213 for the existing\
      \ Phase 0 template.\n\nIn the existing Phase 0 YAML template (lines 184-213),\
      \ add agent fields to the example tasks:\n1. For design generation tasks (0.1-0.5),\
      \ add: agent: systems-designer\n   (and note in the surrounding text that ux-designer\
      \ can be used for UX-focused\n   competitions, or both can be used as pairs\
      \ in the same parallel_group)\n\n2. For the judge task (0.6), leave without\
      \ an agent field (uses default inference)\n3. For the plan extension task (0.7),\
      \ add: agent: planner\n\nAlso add a brief paragraph after the template explaining\
      \ the agent team pattern: when a feature needs both architecture and UX design,\
      \ create paired tasks (one systems-designer + one ux-designer per approach)\
      \ in the same parallel_group. The judge evaluates each pair as a unit.\n\nIMPORTANT:\
      \ Keep the existing text and structure. Only add agent fields to the YAML example\
      \ and the team dispatch paragraph. Do not rewrite the surrounding text.\n"
    depends_on:
    - '2.2'
- id: phase-4
  name: Phase 4 - Verification
  status: pending
  tasks:
  - id: '4.1'
    name: Verify agent files and inference logic
    status: pending
    description: "Run verification checks to confirm all design agents work correctly.\n\
      \n1. Verify all agent files exist and have valid frontmatter:\n\n   python3\
      \ -c \"\n   import yaml, os\n   for agent in ['coder', 'code-reviewer', 'systems-designer',\
      \ 'ux-designer', 'planner']:\n       path = f'.claude/agents/{agent}.md'\n \
      \      assert os.path.exists(path), f'Missing: {path}'\n       content = open(path).read()\n\
      \       parts = content.split('---', 2)\n       assert len(parts) >= 3, f'Invalid\
      \ frontmatter in {path}'\n       meta = yaml.safe_load(parts[1])\n       assert\
      \ 'name' in meta, f'Missing name in {path}'\n       assert 'description' in\
      \ meta, f'Missing description in {path}'\n       assert 'tools' in meta, f'Missing\
      \ tools in {path}'\n       assert 'model' in meta, f'Missing model in {path}'\n\
      \       print(f'OK: {path} - name={meta[\\\"name\\\"]}, model={meta[\\\"model\\\
      \"]}')\n   print('All agent files valid')\n   \"\n\n\n2. Verify expanded inference\
      \ logic with test cases:\n\n   python3 -c \"\n   import sys, os\n   os.chdir('.')\n\
      \n   # Import the inference function by exec-ing just the relevant parts\n \
      \  REVIEWER_KEYWORDS = ['verify', 'review', 'check', 'validate', 'regression',\
      \ 'compliance']\n   DESIGNER_KEYWORDS = ['design', 'wireframe', 'layout', 'architecture',\
      \ 'mockup']\n   PLANNER_KEYWORDS = ['extend plan', 'create tasks', 'create phases',\
      \ 'plan sections']\n\n   def infer(name, desc):\n       searchable = (desc +\
      \ ' ' + name).lower()\n       for kw in REVIEWER_KEYWORDS:\n           if kw\
      \ in searchable:\n               return 'code-reviewer'\n       for kw in PLANNER_KEYWORDS:\n\
      \           if kw in searchable:\n               return 'planner'\n       for\
      \ kw in DESIGNER_KEYWORDS:\n           if kw in searchable:\n              \
      \ return 'systems-designer'\n       return 'coder'\n\n   # Reviewer tests\n\
      \   assert infer('', 'Verify build passes') == 'code-reviewer'\n   assert infer('Review\
      \ code quality', '') == 'code-reviewer'\n   assert infer('', 'Check compliance')\
      \ == 'code-reviewer'\n\n   # Designer tests\n   assert infer('Generate Design\
      \ 1', 'Create architecture') == 'systems-designer'\n   assert infer('', 'Create\
      \ wireframe for dashboard') == 'systems-designer'\n   assert infer('', 'Design\
      \ the layout') == 'systems-designer'\n   assert infer('', 'Create mockup for\
      \ settings page') == 'systems-designer'\n\n   # Planner tests\n   assert infer('Extend\
      \ plan with implementation', '') == 'planner'\n   assert infer('', 'Create tasks\
      \ from winning design') == 'planner'\n   assert infer('', 'Create phases for\
      \ implementation') == 'planner'\n\n   # Coder (default) tests\n   assert infer('Implement\
      \ the feature', '') == 'coder'\n   assert infer('', 'Add unit tests for auth\
      \ module') == 'coder'\n   assert infer('', 'Build the login component') == 'coder'\n\
      \n   print('All inference tests passed (12/12)')\n   \"\n\n\n3. Verify no Python\
      \ syntax errors in both scripts:\n\n   python3 -c \"import py_compile; py_compile.compile('scripts/plan-orchestrator.py',\
      \ doraise=True); print('plan-orchestrator.py: syntax OK')\"\n   python3 -c \"\
      import py_compile; py_compile.compile('scripts/auto-pipeline.py', doraise=True);\
      \ print('auto-pipeline.py: syntax OK')\"\n\n\n4. Verify orchestrator dry-run\
      \ still works:\n\n   python scripts/plan-orchestrator.py --plan .claude/plans/sample-plan.yaml\
      \ --dry-run\n\n\n5. Verify PLAN_CREATION_PROMPT_TEMPLATE contains all five agents:\n\
      \n   python3 -c \"\n   content = open('scripts/auto-pipeline.py').read()\n \
      \  for agent in ['coder', 'code-reviewer', 'systems-designer', 'ux-designer',\
      \ 'planner']:\n       assert agent in content, f'Missing agent {agent} in auto-pipeline.py'\n\
      \       print(f'OK: {agent} found in template')\n   print('All agents present\
      \ in plan creation template')\n   \"\n\n\n6. Verify implement skill mentions\
      \ design agents:\n\n   python3 -c \"\n   content = open('.claude/skills/implement/SKILL.md').read()\n\
      \   for agent in ['systems-designer', 'ux-designer', 'planner']:\n       assert\
      \ agent in content, f'Missing agent {agent} in SKILL.md'\n       print(f'OK:\
      \ {agent} found in SKILL.md')\n   print('All design agents documented in implement\
      \ skill')\n   \"\n\n\nIf any check fails, fix the issue and re-run all checks.\n"
    depends_on:
    - '3.1'
    max_attempts: 5
