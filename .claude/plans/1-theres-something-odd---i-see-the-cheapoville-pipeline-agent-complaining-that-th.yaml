meta:
  name: Fix False-Positive Agent Inference for Reviewer Keywords
  description: Replace single-word REVIEWER_KEYWORDS and DESIGNER_KEYWORDS with multi-word
    phrases to prevent false-positive classification of implementation tasks as code-reviewer
    (READ_ONLY), which strips Edit/Write permissions and causes task failures.
  plan_doc: docs/plans/2026-02-20-1-theres-something-odd---i-see-the-cheapoville-pipeline-agent-complaining-that-th-design.md
  source_item: docs/defect-backlog/1-theres-something-odd---i-see-the-cheapoville-pipeline-agent-complaining-that-th.md
  created: '2026-02-20'
  max_attempts_default: 3
  validation:
    enabled: true
    run_after:
    - coder
    - e2e-test-agent
    - frontend-coder
    validators:
    - validator
    max_validation_attempts: 2
sections:
- id: phase-1
  name: Phase 1 - Fix Keyword Constants and Inference Logic
  status: completed
  tasks:
  - id: '1.1'
    name: Replace single-word REVIEWER_KEYWORDS and DESIGNER_KEYWORDS with multi-word
      phrases
    agent: coder
    status: completed
    description: "Implement the work item: docs/defect-backlog/1-theres-something-odd---i-see-the-cheapoville-pipeline-agent-complaining-that-th.md\n\
      \nDesign doc: docs/plans/2026-02-20-1-theres-something-odd---i-see-the-cheapoville-pipeline-agent-complaining-that-th-design.md\n\
      \nIn scripts/plan-orchestrator.py:\n\n1. Replace REVIEWER_KEYWORDS (around line\
      \ 509) with multi-word phrases:\n   [\"code review\", \"review code\", \"review\
      \ implementation\",\n    \"review changes\", \"verify implementation\", \"verify\
      \ changes\",\n    \"run verification\", \"check compliance\", \"compliance check\"\
      ,\n    \"regression test\", \"regression check\"]\n\n2. Replace DESIGNER_KEYWORDS\
      \ (around line 515) with multi-word phrases:\n   [\"system design\", \"design\
      \ document\", \"architecture design\",\n    \"wireframe\", \"layout design\"\
      , \"mockup\",\n    \"data model design\", \"api design\"]\n\n3. Update the docstring\
      \ for infer_agent_for_task() to reflect the new\n   multi-word phrase approach\
      \ for these keyword lists.\n\n4. Update the comments above REVIEWER_KEYWORDS\
      \ and DESIGNER_KEYWORDS to\n   note they use multi-word phrases (consistent\
      \ with other keyword lists).\n\n5. Run syntax check: python3 -c \"import py_compile;\
      \ py_compile.compile('scripts/plan-orchestrator.py', doraise=True)\"\n\n6. Run\
      \ tests: ~/.pyenv/versions/3.11.*/bin/python -m pytest tests/ -v\n   Fix any\
      \ failures caused by the keyword changes.\n\nFiles: scripts/plan-orchestrator.py\n"
    attempts: 3
    last_attempt: '2026-02-20T23:01:28.190983'
    model_used: sonnet
    validation_findings: 'Validator ''validator'' failed to execute: No status file
      written by Claude'
    validation_attempts: 2
    completed_at: '2026-02-20T23:02:02.449798'
    result_message: REVIEWER_KEYWORDS and DESIGNER_KEYWORDS already updated to multi-word
      phrases in previous attempt. All 349 tests pass, syntax check clean.
- id: phase-2
  name: Phase 2 - Update and Add Regression Tests
  status: pending
  tasks:
  - id: '2.1'
    name: Update existing tests and add false-positive regression tests
    agent: coder
    status: in_progress
    depends_on:
    - '1.1'
    description: "Implement the work item: docs/defect-backlog/1-theres-something-odd---i-see-the-cheapoville-pipeline-agent-complaining-that-th.md\n\
      \nDesign doc: docs/plans/2026-02-20-1-theres-something-odd---i-see-the-cheapoville-pipeline-agent-complaining-that-th-design.md\n\
      \nUpdate tests in tests/test_spec_verifier_ux_reviewer.py:\n\n1. Update test_infer_agent_frontend_does_not_collide_with_reviewer\
      \ (line ~204)\n   which uses task name \"Verify component\" - this single-word\
      \ match no longer\n   triggers code-reviewer. Change the test to use \"Verify\
      \ implementation of component\"\n   or similar multi-word phrase, and assert\
      \ code-reviewer.\n\n2. Add false-positive regression tests to prevent the original\
      \ bug:\n   - test_infer_coder_for_implementation_with_check_keyword:\n     Task:\
      \ name=\"Add content moderation check\", desc=\"Implement input checking\"\n\
      \     Expected: \"coder\" (NOT \"code-reviewer\")\n\n   - test_infer_coder_for_implementation_with_review_keyword:\n\
      \     Task: name=\"Build review UI\", desc=\"Implement the review interface\
      \ for moderators\"\n     Expected: \"coder\" (NOT \"code-reviewer\")\n\n   -\
      \ test_infer_coder_for_implementation_with_validate_keyword:\n     Task: name=\"\
      Add form validation\", desc=\"Validate user input in the registration form\"\
      \n     Expected: \"coder\" (NOT \"code-reviewer\")\n\n   - test_infer_reviewer_for_code_review_phrase:\n\
      \     Task: name=\"Code review\", desc=\"Perform code review of the implementation\"\
      \n     Expected: \"code-reviewer\"\n\n   - test_infer_designer_for_system_design_phrase:\n\
      \     Task: name=\"System design\", desc=\"Create system design for the auth\
      \ module\"\n     Expected: \"systems-designer\"\n\n   - test_infer_coder_for_design_in_implementation_context:\n\
      \     Task: name=\"Implement design system\", desc=\"Build the design tokens\
      \ and theme\"\n     Expected: \"coder\" (NOT \"systems-designer\")\n\n3. Run\
      \ full test suite: ~/.pyenv/versions/3.11.*/bin/python -m pytest tests/ -v\n\
      \   All tests must pass.\n\nFiles: tests/test_spec_verifier_ux_reviewer.py\n"
    attempts: 3
    last_attempt: '2026-02-20T23:08:39.570956'
    model_used: sonnet
    validation_findings: 'Validator ''validator'' failed to execute: No status file
      written by Claude'
    validation_attempts: 2
